On this Memorial Day weekend, with 15,000 U.S troops still deployed to Afghanistan, we bring you a cautionary tale of how five U.S. soldiers, including two Green Berets, died there on the night of June 9, 2014.

As we first reported this past November, the Pentagon concluded the deaths were an "avoidable" accident, known by the contradictory phrase "friendly fire." It was the deadliest such incident involving U.S. fatalities in 17 long years of ongoing war in Afghanistan. It wasn't gunfire that killed the U.S. soldiers, it was a pair of 500-pound bombs dropped right on top of them by a U.S. warplane.

You're about to hear what happened that day from three of the soldiers who were there, including the Green Beret commander. They dispute the official version of events and warn it's going to happen again. It started just after sundown on a sweltering night with a fierce firefight.

Brandon Branch: Bullets whizzing by, kickin up all around you.

Henry "Hank" Montalbano: At certain points it would die down, but it was unrelenting at other points.

Derrick Anderson: It looked almost like a fireworks show where they are shooting down on our positions.

Bill Whitaker: Were you scared?

Brandon Branch: Absolutely. I think you would have to be borderline insane to not have some kinda fear. All you can do at that point is return fire and hope the next one you know doesn't get you.

Brandon Branch was a skilled army combat paramedic -- attached to the Green Berets -- who had dreamed since childhood of being a soldier.

Communications Sergeant Henry "Hank" Montalbano joined the Green Berets after graduating from Williams College.

And Captain Derrick Anderson -- the Green Beret team commander -- could be a poster boy for the Army. Fluent in Arabic, at 29 he was a Bronze Star recipient in Iraq and had led more than 80 combat patrols in Afghanistan. This was supposed to be the team's final mission after a six-month deployment that started in January of 2014.

Bill Whitaker: Did you see much combat?

Henry "Hank" Montalbano: Yes. It would be pretty typical during the course of an operation to take fire.

Derrick Anderson: We had had a long deployment. It was fairly kinetic.

Bill Whitaker: A lot of action.

Derrick Anderson: Yeah. Everyone was coming home safe. We had a few guys from our sister team that had gotten shot on a previous mission…

The 10-man "A" team, was part of the 5th Special Forces Group from Fort Campbell, Kentucky. The group's commander called them the most "disciplined, well-trained and effective" unit in Afghanistan. The Green Berets struck out from forward operating base "Apache", a dusty outpost in restive Zabul Province -- an area dotted with beehives of Taliban fighters hidden in plain sight among the locals.

Derrick Anderson: We knew this area contained Taliban and bad guys. So we understood there was a clear possibility that we would be getting shot at at some point.

Captain Anderson says the Taliban stepped up its attacks when the U.S. announced most of its troops would leave after the Afghan elections in June.

Derrick Anderson: I think the Taliban was trying to make a statement before we left.

Bill Whitaker: What was the mission in the Gaza Valley that day?

Derrick Anderson: So our job, in conjunction with our Afghan partners, were to help the Afghans in going clearing the Gaza Valley from any Taliban that may be hiding and waiting for the elections to come forth and attack the polling sites.

To help understand what happened that night three years ago, using satellite photographs of Afghanistan's Gaza Valley, 60 Minutes commissioned a scale-model of the exact location where the friendly fire took place -- and brought these three soldiers who fought there -- to see it.

CBS News

Derrick Anderson: It's just -- it's surreal to see the whole landscape again, and -- I mean, it definitely brings up memories of that day.

Bill Whitaker: What's the terrain like?

Brandon Branch: It's steep and slippery.

Hours before dawn, on June 9, 2014, giant Chinook helicopters dropped Captain Anderson and his 95-man task force of U.S. and Afghan soldiers into the Gaza Valley to chase away the Taliban fighters. Temperatures soared over 100 degrees as the U.S. troops shadowed their Afghan Allies from rocky ridges.

At the same time, radio intercepts showed the Taliban were also shadowing them. At dusk, the soldiers climbed down to take up positions near three helicopter landing zones.

Bill Whitaker: So the flag here, the red flag, what does that represent?

Derrick Anderson: So that represents where we ended up at the end of the day. Getting ready for pick-up from the helicopters.

Attached to Anderson's Green Beret team was an Air Force controller -- whose identity is classified. He was assigned to the mission just 72 hours earlier. And his job was critical -- to guide Air Force planes on bombing or strafing runs against enemy positions -- it's a battlefield tactic called "close-air support." What the Green Berets didn't know, was that their new air controller had been demoted and kicked out of an Air Force special operations unit for poor performance.

Bill Whitaker: Did you know this guy at all? Did you know anything about him?

Derrick Anderson: At the time we didn't know anything. He showed up a couple days before the mission, so he was getting caught up on the what everything our previous air controller planned out.

Half a mile away from Anderson's group was Army Medic Brandon Branch and two Green Beret weapons sergeants -- Jason McDonald, at 28 a veteran army ranger, and 24-year old Scott Studenmund, the grandson of a U.S. Senator who continued a family tradition of service by becoming a Green Beret.

CBS News

Brandon Branch: Once we got down in this area, there was like, a small ditch that actually kind of ran down through here.

Just before 8 p.m. suddenly, Taliban fighters began shooting down into the ditch where Branch was with Sergeants Studenmund and McDonald.

Brandon Branch: It broke loose at that point.

Captain Anderson watched as the firefight erupted a half mile away.

"Honestly, what's going through my head is that we're gonna die."

Derrick Anderson: From our location here, we could see the fire coming right onto them. They were just in such a vulnerable location down there. Being on low ground, in a ditch. The advantage was from the Taliban.

Henry "Hank" Montalbano: You could see the tracer fire.

Bill Whitaker: Where did you think the shots were coming from?

Brandon Branch: At first, just somewhere in this general direction, in that vicinity.

Bill Whitaker: You couldn't see anybody?

Brandon Branch: We couldn't see anybody at the time. It was just somebody shooting.

Bill Whitaker: The bullets are hittin' all around you. You can hear them going by?

Brandon Branch: Right. Yes sir.

Bill Whitaker: Were you returning fire?

Brandon Branch: Absolutely. Absolutely.

Under heavy fire, Green Beret Scott Studenmund scaled the hill with three other U.S. soldiers and an Afghan sergeant to take up a more defendable position.

They carried a machine gun, a grenade launcher and rifles to fight off the Taliban. Before scrambling up the hill to join the other soldiers, Sergeant Jason McDonald sounded an urgent alarm over the radio -- "troops in contact."

Derrick Anderson: He started asking for immediate support from aircraft.

Bill Whitaker: It got that bad that quickly.

Derrick Anderson: Absolutely sir. Jason got on the radio and said, "Get me the aircraft now."

Bill Whitaker: Have you heard him say that before?

Derrick Anderson: No, at no point during the deployment had we ever really heard anyone with the urgency in their voice and or necessity.

Brandon Branch: Honestly, what's going through my head is that we're gonna die.

The plane sent to the aid of the special forces that night was a "B-1" -- a high-flying strategic bomber -- not the type of aircraft typically used for close air support missions in Afghanistan. That night, the B-1 had a belly-full of bombs and a cylindrical tube called a "sniper-pod" slung beneath its' fuselage. A Sniper Pod is a precision targeting system bristling with cameras and sensors that streams images like these to the bomber's four-man crew.

As darkness fell on the moonlit valley, the Green Berets switched on infrared strobes attached to their helmets and pulled night vision devices over their eyes which allow U.S. soldiers and aircrews to identify friend from foe in the chaos of the battlefield.

Bill Whitaker: You can see the strobe lights?

Derrick Anderson: Yeah.

Brandon Branch: Right.

Bill Whitaker: And everybody's got one?

Derrick Anderson: Correct.

Bill Whitaker: So if you're looking at all of your guys out there, you're seeing lights all over the place?

Derrick Anderson: Yeah, I mean I have pilot buddies and I have friends that have said it can often times look like -- like a Christmas tree in the valley.

Bill Whitaker: What about the B-1 bomber? Does it see the strobe lights?

Derrick Anderson: It cannot.

Bill Whitaker: It cannot?

Derrick Anderson: We thought it could

The classified official investigation obtained by 60 Minutes, later concluded that everyone -- the soldiers -- the bomber crew -- the Air Force controller -- all thought the B-1 targeting system was capable of detecting infrared strobes. They were all wrong.

Bill Whitaker: So it was your belief that this B-1 bomber could see your strobe lights going off?

Derrick Anderson: Correct. Yes -- and, you know, throughout any operation we've always -- had the general assumption that these aircraft can.

The B-1 targeting system could see gunfire coming from Sergeants McDonald and Studenmund who were shooting at the Taliban from the hillside above Medic Brandon Branch. But because the plane's crew couldn't see the Green Berets' strobes, they mistook their muzzle flashes for the Taliban.

"My gut dropped. I just felt something sink to the bottom of my stomach, and I was like, 'No, this -- no. This isn't happening.'"

And that was just one of a cascade of critical errors according to the investigation of the incident. The report charges that in the heat of battle Captain Anderson lost track of the soldiers who had climbed the hill to fight the Taliban. The Air Force controller with Anderson -- whose job it was to pinpoint enemy targets -- admitted he made a mistake and sent conflicting positions for U.S. and enemy fighters to the bomber. The B-1 aborted its bomb run on three passes as technical glitches and the mountainous terrain garbled radio transmission.

Bill Whitaker: How long did that take?

Derrick Anderson: It ended up taking a total of 21 minutes.

Bill Whitaker: And all of this time you are under fire?

Brandon Branch: Right.

The report also revealed that as the bomber circled 12,000 feet above them, instead of targeting the Taliban, the Air Force controller made a fatal mistake -- he gave the B-1 crew the location of the U.S. soldiers as the target -- and: "improperly directed the aircraft over a friendly position." No one in the bomber challenged the air controller's conflicting positions for U.S. and enemy fighters -- that should have been a red flag.

The Air Force controller with the Green Berets radioed the bomber: "Be advised, friendlies are the only ones marked by [infrared] strobes… So anybody else… is enemy target."

Six minutes later he asked: "Any [infrared] strobes in your sensor at this time?"

The bomber crew responded: "Negative [infrared] strobes."

The B-1 crew did have hand-held night vision goggles -- but, they were out of range of the strobes.

Finally, the B-1 released two 500-pound bombs -- directly on the six soldiers at the top of the hill.

Brandon Branch: And as soon as it happened, it was all of a sudden this shocked moment of "oh my god –- they just hit our hill."

Derrick Anderson: And -- my gut dropped. I just felt something sink to the bottom of my stomach, and I was like, "No, this -- no. This isn't happening."

Brandon Branch: I grabbed my aid bag and I took off up the hill to try to go see if anybody had survived it, and if, you know if there was anybody that needed help. And I heard, "You gotta get over here." I found Scott.

Bill Whitaker: What was his condition?

Brandon Branch: He was in -- in bad shape. He was talkin' to us at first -- askin' what just happened. And while we began workin' on him, we just told him, "I don't -- I don't know what happened. I don't know what happened. But somethin' messed up." I was applyin' tourniquets and trying to stop what was happening-- Tryin' to stop the bleeding. There was really nothin' else that-- that I could do.

Bill Whitaker: I understand you said a prayer?

Brandon Branch: I just asked that God be with him and with his family.

CBS News

Staff Sergeant Scott Studenmund died on that hilltop. Also killed -- Staff Sergeant Jason McDonald, the father of two girls. 19-year-old Private First Class Aaron Toppen, Specialist Justin Helton, 25, Corporal Justin Clouse, 22 and 31-year-old Afghan Sergeant Gulbuddin Sakhi. Over the next days -- memorial services were held for the fallen soldiers at Forward Operating Base Apache and at an airfield in Kandahar, Afghanistan.

Later, Scott Studenmund and Jason McDonald were laid to rest with full military honors at Arlington National Cemetery.

The Pentagon appointed then-Air Force Major General Jeffrey Harrigian to investigate the friendly fire accident. After an eight-week probe, the general issued a report that concluded the "incident was avoidable" and he spread the blame around -- to the Air Force controller, to the bomber crew, and to the Army Green Berets.

Bill Whitaker: Let me go over some of the findings. It says, "Though this was a challenging set of circumstances, had the team executed standard tactics, techniques and procedures, and communicated effectively, this incident was avoidable." What do you think of that statement?

Derrick Anderson: I disagree with that statement.

But the investigation singled out Captain Anderson -- who had led his team on more than 80 combat missions in Afghanistan -- for especially tough criticism. It charged that he lost track of his men and that his failures, "Caused him to misidentify friendly forces as enemy."

Bill Whitaker: They said you didn't know that five of the members had moved up the hillside. And that you should have. That's sort of a major point for them in the investigation.

Derrick Anderson: I think that's an untrue statement.

Anderson told us the soldiers on the hill were within what he thought was their standard security perimeter.

Bill Whitaker: Do you bear any responsibility for what happened.

Derrick Anderson: I'm the commander of this team. This is my team. I miss my guys tremendously. But at the end of the day there's nothing that myself or my Team Sergeant did that day or failed to do that day that caused that incident to happen. There's a thousand different things that can happen during firefight missions. We made the decisions that we thought were best at the time on the ground for the guys that were getting shot at.

CBS News

Bill Whitaker: The report goes on to say that from you, there was -- a sense of urgency to drop the bombs that was perhaps unnecessary. So in other words, you were making this seem like it was a bigger deal than it actually was.

Brandon Branch: I was there. It was a big deal.

Bill Whitaker: They called it a false sense of urgency.

Brandon Branch: They can call it that, but they weren't there. Twenty-one minutes is an eternity when you're bein' shot at.

Henry "Hank" Montalbano: It's ignoring some of the fundamental reasons why this occurred.

Bill Whitaker: They looked at the wrong things?

Brandon Branch: Right.

Henry "Hank" Montalbano: Yes. The root cause of the friendly fire incident hasn't been adequately addressed yet. There's an aircraft carrying out close air support missions that can't detect the common marking mechanism at night-time. It's dangerous to use an aircraft that's incapable of picking up infrared strobes.

The families of the fallen soldiers were briefed by a team of five officers led by General Harrigian. One of those gold-star parents was Woody Studenmund -- an economics' professor at California's Occidental College -- and the father of Green Beret Staff Sergeant Scott Studenmund. Studenmund interviewed all but two of his son's teammates and has methodically and repeatedly reviewed every line of the declassified investigative report in a personal quest to understand how and why his son died.

Bill Whitaker: Were you satisfied with the investigation?

Woody Studenmund: How can a parent be satisfied with an investigation into their son's death when the basic cause hasn't been corrected? and that is that the B-1 bomber Sniper Pod was not capable of seeing the strobes that the Green Berets were wearing. So they dropped the bombs.

CBS News

In a Skype interview from his headquarters in Qatar, we asked General Harrigian -- who led the investigation -- why the bomber crew didn't know their targeting system could not see infrared strobes on the soldiers' helmets.

Bill Whitaker: How is it possible that the air crew didn't know what their plane was capable or incapable of doing?

General Jeffrey Harrigian: They should have known quite frankly. That's part of the academics that are given to them. So it was there, but the crew didn't remember that. The ground crew should have known just as well that their [infrared] strobe could not be seen by the Sniper Pod.

Yet the general's own report says, "These capabilities were not specifically covered… in Sniper Academics." In other words, Air Force bomber crews were not taught that their targeting system can't detect infrared strobes.

General Harrigian -- who was promoted and is now in charge of all Air Force operations in Afghanistan, Iraq and Syria -- says the command sent an urgent bulletin to all its aircrews eleven days after the incident, "to ensure they understand the capability and limitations of their aircraft's… sensors to detect" strobes. Still, the Air Force general insists the B-1 is not to blame. He faults the people on the ground -- the Air Force controller and the Green Berets -- for failing to keep track of each other and accurately communicate their positions to the bomber.

General Jeffrey Harrigian: The individuals on the ground have a responsibility, have a duty to know where their teammates are. And they're the ones that are communicating that information to the aircrew.

Bill Whitaker: Could that discrepancy have been overcome if the crew had been able to see the infrared strobes?

General Jeffrey Harrigian: Without a doubt.

Bill Whitaker: People will say that this incident proves that the B-1 is not suited for that kind of close air support.

General Jeffrey Harrigian: This incident had nothing to do with the platform. This incident had everything to do with the humans involved with what happened here.

Woody Studenmund: I think that when humans are under fire, in fear for their lives, and they make mistakes, that's different from a government not understanding the capabilities of the weapon systems that it sends out to help our troops.

Studenmund is convinced the B-1 targeting system is responsible for his son's death.

Woody Studenmund: None of the other mistakes mattered -- none of them mattered. When we send our soldiers into battle, it's wrong to have them using a weapon system which isn't capable of doing what it's supposed to be doing. It's not murder, but it's close.

CBS News

Studenmund wanted to speak to us on camera because he fears a similar mistake will happen again. His dead son's comrades agree and told us the report's criticism of Captain Anderson was unjust.

Brandon Branch: if I got a phone call today that said, 'You have got to go back to Afghanistan.' These were the guys that I would want to be back with." If they had messed up to the level that that report says that they messed up, I would not want to do that.

Captain Anderson's role in the accident effectively ended his Green Beret career, even though his commanding general concluded he did not deserve to be punished. He left the special forces and is now a law student at Georgetown University. Anderson still serves in the Army National Guard.

Hank Montalbano, who was held blameless by the investigation, also left the Green Berets and is now an MBA candidate at the University of Washington.

Brandon Branch, who was also not faulted in the report, was medically retired due to injuries he sustained in Afghanistan. He lives in Louisiana.

"That's what scares me. That's what I'm mad about. That we haven't fixed a problem that could potentially kill more of our service members."

The air controller who gave the bomber the wrong target coordinates was stripped of his combat qualifications. He transferred to the Air National Guard and recently helped manage rescue helicopters after Hurricane Harvey last year.

The B-1 aircrew, after re-training, was cleared to fly again.

As for the bomber's targeting system -- it still cannot detect infrared strobes.

Bill Whitaker: It's been three years. Do you ever stop thinking about that day?

Brandon Branch: There was a time frame after that day that it literally almost destroyed me. And that, for a long time it-- it ate at me. And while I still think about that every day, while I still see that every day, I think it would do them injustice for me to live my life in that moment every day.

Bill Whitaker: You fear what happened to you could happen again?

Derrick Anderson: Yes.

Bill Whitaker: All of you?

Henry "Hank" Montalbano: Absolutely.

Brandon Branch: Absolutely.

Derrick Anderson: We still have U.S. service members throughout the world in harm's way that are going to rely on this aircraft again. And that's what disheartens me. That's what scares me. That's what I'm mad about. That we haven't fixed a problem that could potentially kill more of our service members.

Since our story first aired this past November, the Air Force sent a squadron of B-1 bombers back to the region to fly missions over Afghanistan.

Produced by Howard L. Rosenberg and Julie Holstein.